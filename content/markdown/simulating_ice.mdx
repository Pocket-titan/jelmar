---
title: Simulating an ice sheet
date: 2024-05-29
excerpt: Using the SICOPOLIS model, we simulate the Greenland ice sheet under a high-emissions scenario.
---

Most of our future projections about the effects of climate change are informed by computer models. These models are based on the laws of physics and aim to capture a part of the climate system (e.g. the atmosphere, the ocean, the ice sheets). They can stand alone, or they can be coupled to other models to better represent the feedback loops that often exist at the boundaries of Earth's systems. Atmospheric warming results in a warmer ocean, which *likely* affects ocean circulation (such as the thermohaline pump) and currents (like El Niño and La Niña), all of which accelerate the melting of ice sheets, which reduces the amount of sunlight reflected, in turn warming the atmosphere more... you get the point. It's all interconnected.

In this post we'll be focusing on a single part of this system: the Greenland ice sheet. It's the second largest body of ice in the world next to Antarctica, but it's melting the fastest: it's estimated to have lost around $243\ \text{Gt}$ per year over the period 2010-2019. In contrast, the Antarctic sheet's estimated loss rate is "only" $148\ \text{Gt}\ \text{yr}^{-1}$ over that same period.[^1]

We'll be using the [SICOPOLIS](https://www.sicopolis.net) model to simulate the evolution of the Greenland ice-sheet under a particular high-emissions scenario. But what is a model, and why should you care?

[^1]: IPCC, 2021: *"Climate Change 2021: The Physical Science Basis"*. Chapter 9 [supplementary material](https://www.ipcc.ch/report/ar6/wg1/downloads/report/IPCC_AR6_WGI_Chapter09_SM.pdf), table 9.SM.1.

# Ice-sheet models

A *model* is a simplification of reality. When we neglect air resistance, assume a spherical cow, or say that a car uses a certain amount of fuel per distance traveled (even though this depends on the speed of the car), we are creating a model. This means that they're fundamentally ignoring things by not taking them into account, but as the famous quote attributed to George Box goes:

> All models are wrong, but some are useful.

The thing that makes models *"wrong"* is also what makes them *useful* most of the time. It would take centuries to simulate every single atom in the Greenland sheet, but realizing that the forces that dominate glacier movements happen on a much larger scale is the key that allows us to simplify. Of course, these are assumptions that you should test, but that's part of the scientific process. One way of validating models is by having them "predict the past", which we can compare to historical data like the geological record.

Most computer models operate using a fundamental equation:

$$
\begin{equation}
  x(t_{i+1}) = \mathcal{L}(x(t_i))
\end{equation}
$$

This is saying that our **state** $x$ at the next timestep $t_{i+1}$ is given by some function $\mathcal{L}$ (our model) applied to the state at the current timestep $t_i$. In ice-sheet models, that function $\mathcal{L}$ contains 2 main physical processes (usually in the form of partial differential equations):

1. Snow fall and melt (which together make up the *surface mass balance*)
2. Ice flow; the physical movement of the glacier (internal deformation, basal *sliding*, calving)

Some models will include more or less detail based on the assumptions they make (mostly related to internal stresses): the shallow ice and shallow shelf approximation being the most common. I won't go into more depth on them here but if you want to read more about these processes and assumptions, I recommend the `antarcticglaciers.org` page: they have great sources on [glacier flow](https://www.antarcticglaciers.org/glacier-processes/glacier-flow-2/glacier-flow/) and [mass balance](https://www.antarcticglaciers.org/glacier-processes/mass-balance/glacier-accumulation-and-ablation/), for example.

Apart from these processes, models also rely on *external inputs*. This can be temperature, precipitation or sea level data, but also the initial state of the ice sheet. These are the knobs we can turn, after which we let the physics play it out. And it's with this step in mind that we can start modeling our ice sheet!

# Setup

We're going to start by [installing](https://sicopolis.readthedocs.io/en/latest/getting_started.html) SICOPOLIS. Installing NetCDF can be quite a hassle on MacOS (which I am); I recommend using [MacPorts](https://ports.macports.org/port/netcdf-fortran/) in that case. Note that we won't really need LIS (we're only simulating land ice), so you can skip that part of the installation if you want.

<Note type="info">
  If you want to follow along, this whole article is available as an executable Jupyter notebook [here](https://link.com).
</Note>

After it's installed, we're going to retrieve the input data for our model run. We're going to need to tell the model what the temperature is going to be in the future. I'm going to use one of the IPCC's Representative Concentration Pathways (RCP), which is a scenario of our future CO<sub>2</sub> emissions. I'm going to go with the quite pessimistic emissions scenario [RCP 8.5](https://en.wikipedia.org/wiki/Representative_Concentration_Pathway#RCP_8.5), so we can really see the difference in the ice sheet. The original RCP scenarios are only defined until 2100, so we're going to use ECP 8.5 (*Extended Concentration Pathway*), which extends until 2300.[^2]

[^2]: van Vuuren, Detlef P., et al. *“The Representative Concentration Pathways: An Overview.”* Climatic Change, vol. 109, no. 1–2, Springer Science and Business Media LLC, 5 Aug. 2011, pp. 5–31. [doi:10.1007/s10584-011-0148-z](https://psl.noaa.gov/ipcc/cmip5/rcp.pdf).

<Image caption={<span>RCP and ECP emissions scenarios. Reproduced from <FootnoteLabel nosup>2</FootnoteLabel>. </span>} maxHeight={275} src="/images/notebooks/simulating_ice/markdown_image_12_0.png" width={1172} height={460} />

[CMIP5 monthly data on single levels](https://cds.climate.copernicus.eu/cdsapp#!/dataset/projections-cmip5-monthly-single-levels?tab=overview) dataset.

Follow the instructions [here](https://cds.climate.copernicus.eu/api-how-to) to setup `cdsapi` and accept the Terms of Use for the dataset

It will generate the following request:

<Cell cell={{"cell_type":"code","execution_count":5,"metadata":{"language":"python"},"outputs":[],"source":["from pathlib import Path\n","import cdsapi\n","\n","DATA_DIR = Path(\"data\")\n","DATA_DIR.mkdir(exist_ok=True)\n","\n","if not (DATA_DIR / \"download.zip\").exists():\n","    c = cdsapi.Client()\n","\n","    c.retrieve(\n","        \"projections-cmip5-monthly-single-levels\",\n","        {\n","            \"variable\": \"2m_temperature\",\n","            \"period\": \"200601-230012\",\n","            \"experiment\": \"rcp_8_5\",\n","            \"model\": \"ipsl_cm5a_lr\",\n","            \"ensemble_member\": \"r1i1p1\",\n","            \"format\": \"zip\",\n","        },\n","        f\"{DATA_DIR}/download.zip\",\n","    )"]}}/>

Which, after unzipping:

<Cell cell={{"cell_type":"code","execution_count":6,"metadata":{"language":"python"},"outputs":[{"name":"stdout","output_type":"stream","text":["Archive:  data/download.zip\n","  inflating: data/tas_Amon_IPSL-CM5A-LR_rcp85_r1i1p1_200601-230012.nc  \n"]}],"source":["!unzip -o $DATA_DIR/download.zip -d $DATA_DIR"]}}/>

...gives us a netCDF file that looks a little like this.

<Cell cell={{"cell_type":"code","execution_count":7,"metadata":{"language":"python"},"outputs":[{"name":"stdout","output_type":"stream","text":["('time', (3540,))\n","('time_bnds', (3540, 2))\n","('lat', (96,))\n","('lat_bnds', (96, 2))\n","('lon', (96,))\n","('lon_bnds', (96, 2))\n","('height', ())\n","('tas', (3540, 96, 96))\n"]},{"data":{"text/plain":["<class 'netCDF4._netCDF4.Variable'>\n","float32 tas(time, lat, lon)\n","    standard_name: air_temperature\n","    long_name: Near-Surface Air Temperature\n","    units: K\n","    original_name: t2m\n","    cell_methods: time: mean (interval: 30 minutes)\n","    cell_measures: area: areacella\n","    history: 2011-08-16T21:57:47Z altered by CMOR: Treated scalar dimension: 'height'. 2011-08-16T21:57:47Z altered by CMOR: replaced missing value flag (9.96921e+36) with standard missing value (1e+20). 2011-08-16T21:57:48Z altered by CMOR: Inverted axis: lat.\n","    coordinates: height\n","    missing_value: 1e+20\n","    _FillValue: 1e+20\n","    associated_files: baseURL: http://cmip-pcmdi.llnl.gov/CMIP5/dataLocation gridspecFile: gridspec_atmos_fx_IPSL-CM5A-LR_rcp85_r0i0p0.nc areacella: areacella_fx_IPSL-CM5A-LR_rcp85_r0i0p0.nc\n","unlimited dimensions: time\n","current shape = (3540, 96, 96)\n","filling on"]},"execution_count":7,"metadata":{},"output_type":"execute_result"}],"source":["from netCDF4 import Dataset\n","\n","grp = Dataset(next(DATA_DIR.rglob(\"*.nc\")).absolute())\n","\n","print(*[(key, grp.variables[key].shape) for key in grp.variables.keys()], sep=\"\\n\")\n","grp.variables[\"tas\"]"]}}/>

# Creating input data

It is between latitudes 59° and 83°N, and longitudes 11° and 74°W.

This translates to lat: \[59, 83], lon: \[286, 349]

<Cell cell={{"cell_type":"code","execution_count":8,"metadata":{"language":"python"},"outputs":[{"data":{"image/png":"/images/notebooks/simulating_ice/cell_output_22_0.png","text/plain":["<Figure size 640x480 with 2 Axes>"]},"metadata":{},"output_type":"display_data"}],"source":["import matplotlib.pyplot as plt\n","\n","[lat, lon] = [grp[\"lat\"][:], grp[\"lon\"][:]]\n","tas = grp[\"tas\"][:, (lat >= 59) & (lat <= 83), (lon >= 286) & (lon <= 349)]\n","mask = tas[-1] < 273.15\n","x = tas[-1]\n","\n","x[mask] = x[mask]\n","x[~mask] = 273.15\n","\n","plt.imshow(x[::-1])\n","plt.grid(False)\n","plt.colorbar();"]}}/>

<Cell cell={{"cell_type":"code","execution_count":9,"metadata":{"language":"python"},"outputs":[{"name":"stdout","output_type":"stream","text":["temps = [240.47 242.   243.91 ... 268.34 265.52 263.22]\n","yrs = [  0   0   0 ... 294 294 294]\n","chunked =\n","\t[[240.47 242.   243.91 ... 254.38 248.07 241.32]\n","\t [238.61 239.11 243.87 ... 252.68 246.61 243.23]\n","\t [239.68 240.64 243.54 ... 251.35 243.64 242.59]\n","\t ...\n","\t [258.91 263.27 261.72 ... 269.57 265.38 262.05]\n","\t [258.28 257.18 258.25 ... 269.48 267.91 264.15]\n","\t [258.52 259.41 260.15 ... 268.34 265.52 263.22]]\n"]},{"data":{"image/png":"/images/notebooks/simulating_ice/cell_output_23_1.png","text/plain":["<Figure size 1000x400 with 2 Axes>"]},"metadata":{},"output_type":"display_data"}],"source":["temps = np.mean(np.asarray(tas[:, mask]), axis=-1)\n","print(f\"temps = {temps}\")\n","\n","yrs = np.array(grp.variables[\"time\"][:] // 365).astype(int)\n","print(f\"yrs = {yrs}\")\n","\n","chunked = np.array([temps[yrs == yr] for yr in np.unique(yrs)])\n","print(f\"chunked =\\n{\"\\n\\t\".join([\"\", *f\"{chunked}\".split(\"\\n\")])[1:]}\")\n","\n","fig, axes = plt.subplots(nrows=1, ncols=2, sharey=True, figsize=(10, 4))\n","\n","\n","avgs = np.mean(chunked, axis=-1)\n","axes[0].plot(avgs - avgs[0])  # Kelvin difference == Celsius difference\n","axes[0].set_ylabel(r\"$\\Delta$T [$\\degree$C]\")\n","axes[0].set_title(\"Yearly average\")\n","\n","\n","def smooth(x: np.ndarray, wlen: int) -> np.ndarray:\n","    w = np.ones(wlen, \"d\")\n","    padded = np.pad(x, (wlen // 2, wlen - 1 - wlen // 2), mode=\"edge\")\n","    return np.convolve(padded, w / w.sum(), mode=\"valid\")\n","\n","\n","smoothed_temps = smooth(avgs, 10)\n","axes[1].plot(smoothed_temps - smoothed_temps[0])\n","axes[1].set_title(\"Smoothed\");"]}}/>

Nice! Now we have to write this out to a file that SICOPOLIS understands. `sico_in/general/grl_warming_scenario_rcp26.asc`. We'll take the temperature from there, too.

<Cell cell={{"cell_type":"code","execution_count":10,"metadata":{"language":"python"},"outputs":[{"name":"stdout","output_type":"stream","text":["295 295\n"]}],"source":["dt_2006 = 5.8161056e-01\n","\n","time = 2006 + np.unique(yrs) - 1990\n","dtemps = (smoothed_temps - smoothed_temps[0]) + dt_2006\n","print(len(time), len(dtemps))"]}}/>

<Cell cell={{"cell_type":"code","execution_count":11,"metadata":{"language":"python"},"outputs":[],"source":["start, end = time[[0, -1]]\n","step = time[1] - time[0]\n","\n","contents = f\"\"\"#  {start}  {step}  {end}\n","{\"\\n\".join([f\"  {yr}  {t}\" for yr, t in zip(time, dtemps)])}\n","\n","# --------------------------------------------------------------------------------\n","# Greenland surface temperature anomaly from RCP8.5 scenario for years 2006 - 2300\n","# Year (relative to 1990 CE) - Delta T [C]\n","# --------------------------------------------------------------------------------\n","\"\"\"\n","\n","with open(f\"{DATA_DIR}/grl_rcp85.dat\", \"w\") as f:\n","    f.write(contents)"]}}/>

# Running the model

Now we can actually run the model.

a = annus; years in Latin.

`-a` doesn't take relative paths - so no `-a ./sico_in/...`, but `-a /home/user/sicopolis/sico_in/...`.

`(./sico.sh -f -m repo_grl20_b2_paleo21) >tmp/out_001.dat` (took \~1h12m)
`(./sico.sh -f -m grl20_rcp85 -a /home/jelmar/Github/portfolio/sicopolis/sico_out/repo_grl20_b2_paleo21) >tmp/out_001.dat`

<Note type="info">info</Note>

<Note type="warning">
  warning
</Note>

<Code language="fortran" oldFilename="sico_specs_repo_grl10_b2_future21_asmb.h" filename="sico_specs_grl20_rcp85.h" oldValue="file:./data/sico_specs_repo_grl10_b2_future21_asmb.h" value="file:./data/sico_specs_grl20_rcp85.h" />

# Processing output data

Output files will be in the folder `sico_out/grl20_rcp85` (or whatever name you gave to your specfile). An explanation of what these different files contain can be found [here](https://sicopolis.readthedocs.io/en/develop/getting_started.html#getting-started-output), but the gist of it is that the `.ser` or `_ser.nc` files contain scalar variables (`ser` meaning time series), the `.site` or `_site.nc` also contain (different) scalar variables sampled at particular *sites* (which are predefined and specific to your modeling domain), and the files that end in `0001.nc`, `0002.nc` etc. contain full 2D/3D fields (e.g. ice velocity or thickness). These fields are written out at the times we set on line 1322 of our specfile, so in our case it's once every 50 years.

Your directory should look something like this:

<FileTree
  items={[
    {
      name: "sico_out",
      items: [{
        name: "grl20_rcp85",
        items: [
          "grl20_rcp85.core",
          "out_grl20_rcp85.dat",
          "sico_specs_grl20_rcp85.h",
          "grl20_rcp85.log",
          "host_info.log",
          "grl20_rcp85_core.nc",
          "grl20_rcp85_ser.nc",
          "grl20_rcp850001.nc",
          "grl20_rcp850002.nc",
          "grl20_rcp850003.nc",
          "grl20_rcp850004.nc",
          "grl20_rcp850005.nc",
          "grl20_rcp850006.nc",
          "grl20_rcp850007.nc",
          "grl20_rcp85.ser",
        ]
      }]
    }
  ]}
/>

As a first sanity check, we'll get the surface temperature anomaly from the `grl20_rcp85_ser.nc` file to make sure that it corresponds to the input data we generated.

<Cell cell={{"cell_type":"code","execution_count":null,"metadata":{"language":"python"},"outputs":[{"data":{"image/png":"/images/notebooks/simulating_ice/cell_output_39_0.png","text/plain":["<Figure size 1000x400 with 2 Axes>"]},"metadata":{},"output_type":"display_data"}],"source":["sim_name = \"grl20_rcp85\"\n","root = f\"{SICOPOLIS_DIR}/sico_out/{sim_name}\"\n","start_year = 1990\n","\n","ser = Dataset(f\"{root}/{sim_name}_ser.nc\")\n","\n","[time, delta_ts, V_sle] = [ser.variables[x][:] for x in [\"t\", \"delta_ts\", \"V_sle\"]]\n","sle = (V_sle - V_sle[0]) * -1\n","time += start_year\n","\n","fig, axes = plt.subplots(nrows=1, ncols=2, figsize=(10, 4))\n","axes[0].plot(time, delta_ts)\n","axes[1].plot(time, sle)\n","\n","axes[0].set_ylabel(\"Surface temperature anomaly [C]\")\n","axes[1].set_ylabel(\"Sea level rise [m]\")\n","\n","for ax in axes:\n","    ax.set_xlabel(\"Time [yr]\")"]}}/>

<Collapsed>

<Cell cell={{"cell_type":"code","execution_count":null,"metadata":{"language":"python"},"outputs":[],"source":["filenames = [f\"{root}/{sim_name}{i:04}.nc\" for i in range(2, 7 + 1)]\n","keys = [\"as_perp\", \"H\", \"lat\", \"lon\", \"mask\", \"zs\"]\n","\n","data = {}\n","for filename in filenames:\n","    with Dataset(filename) as grp:\n","        year = start_year + grp.variables[\"time\"][:]\n","        data[year] = {k: grp.variables[k][:] for k in keys}"]}}/>

<Cell cell={{"cell_type":"code","execution_count":null,"metadata":{"language":"python"},"outputs":[{"data":{"text/plain":["(-183.03348, 3267.3389)"]},"execution_count":146,"metadata":{},"output_type":"execute_result"}],"source":["rho_ice = 916.7  # [kg/m^3]\n","SMBs = [(x[\"H\"] > 0) * x[\"as_perp\"] * rho_ice for x in data.values()]\n","\n","zs = [np.ma.masked_where(~((x[\"mask\"] == 0) | (x[\"mask\"] == 1)), x[\"zs\"]) for x in data.values()]\n","zs = [(x.min(), x.max()) for x in zs]\n","\n","SMB_min, SMB_max = [np.min(SMBs), np.max(SMBs)]\n","z_min, z_max = [np.min(zs), np.max(zs)]\n","\n","z_min, z_max"]}}/>

<Cell cell={{"cell_type":"code","execution_count":null,"metadata":{"language":"python"},"outputs":[{"ename":"KeyboardInterrupt","evalue":"","output_type":"error","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mValueError\u001b[0m                                Traceback (most recent call last)","File \u001b[0;32m~/.pyenv/versions/3.12.0/lib/python3.12/site-packages/matplotlib/cbook.py:298\u001b[0m, in \u001b[0;36mCallbackRegistry.process\u001b[0;34m(self, s, *args, **kwargs)\u001b[0m\n\u001b[1;32m    297\u001b[0m \u001b[38;5;28;01mtry\u001b[39;00m:\n\u001b[0;32m--> 298\u001b[0m     \u001b[43mfunc\u001b[49m\u001b[43m(\u001b[49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[43margs\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[43mkwargs\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m    299\u001b[0m \u001b[38;5;66;03m# this does not capture KeyboardInterrupt, SystemExit,\u001b[39;00m\n\u001b[1;32m    300\u001b[0m \u001b[38;5;66;03m# and GeneratorExit\u001b[39;00m\n","File \u001b[0;32m~/.pyenv/versions/3.12.0/lib/python3.12/site-packages/matplotlib/contour.py:1152\u001b[0m, in \u001b[0;36mContourSet.changed\u001b[0;34m(self)\u001b[0m\n\u001b[1;32m   1151\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mset_array(\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mcvalues)\n\u001b[0;32m-> 1152\u001b[0m \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mupdate_scalarmappable\u001b[49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m   1153\u001b[0m alphas \u001b[38;5;241m=\u001b[39m np\u001b[38;5;241m.\u001b[39mbroadcast_to(\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mget_alpha(), \u001b[38;5;28mlen\u001b[39m(\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mcvalues))\n","File \u001b[0;32m~/.pyenv/versions/3.12.0/lib/python3.12/site-packages/matplotlib/collections.py:920\u001b[0m, in \u001b[0;36mCollection.update_scalarmappable\u001b[0;34m(self)\u001b[0m\n\u001b[1;32m    919\u001b[0m         \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_alpha \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_alpha\u001b[38;5;241m.\u001b[39mreshape(\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_A\u001b[38;5;241m.\u001b[39mshape)\n\u001b[0;32m--> 920\u001b[0m     \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_mapped_colors \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mto_rgba\u001b[49m\u001b[43m(\u001b[49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43m_A\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43m_alpha\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m    922\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_face_is_mapped:\n","File \u001b[0;32m~/.pyenv/versions/3.12.0/lib/python3.12/site-packages/matplotlib/cm.py:509\u001b[0m, in \u001b[0;36mScalarMappable.to_rgba\u001b[0;34m(self, x, alpha, bytes, norm)\u001b[0m\n\u001b[1;32m    508\u001b[0m     x \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mnorm(x)\n\u001b[0;32m--> 509\u001b[0m rgba \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mcmap\u001b[49m\u001b[43m(\u001b[49m\u001b[43mx\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43malpha\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43malpha\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;28;43mbytes\u001b[39;49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[38;5;28;43mbytes\u001b[39;49m\u001b[43m)\u001b[49m\n\u001b[1;32m    510\u001b[0m \u001b[38;5;28;01mreturn\u001b[39;00m rgba\n","File \u001b[0;32m~/.pyenv/versions/3.12.0/lib/python3.12/site-packages/matplotlib/colors.py:725\u001b[0m, in \u001b[0;36mColormap.__call__\u001b[0;34m(self, X, alpha, bytes)\u001b[0m\n\u001b[1;32m    724\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_isinit:\n\u001b[0;32m--> 725\u001b[0m     \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43m_init\u001b[49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m    727\u001b[0m xa \u001b[38;5;241m=\u001b[39m np\u001b[38;5;241m.\u001b[39marray(X, copy\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mTrue\u001b[39;00m)\n","File \u001b[0;32m~/.pyenv/versions/3.12.0/lib/python3.12/site-packages/matplotlib/colors.py:1175\u001b[0m, in \u001b[0;36mListedColormap._init\u001b[0;34m(self)\u001b[0m\n\u001b[1;32m   1174\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_lut \u001b[38;5;241m=\u001b[39m np\u001b[38;5;241m.\u001b[39mzeros((\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mN \u001b[38;5;241m+\u001b[39m \u001b[38;5;241m3\u001b[39m, \u001b[38;5;241m4\u001b[39m), \u001b[38;5;28mfloat\u001b[39m)\n\u001b[0;32m-> 1175\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_lut[:\u001b[38;5;241m-\u001b[39m\u001b[38;5;241m3\u001b[39m] \u001b[38;5;241m=\u001b[39m \u001b[43mto_rgba_array\u001b[49m\u001b[43m(\u001b[49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mcolors\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m   1176\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_isinit \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;01mTrue\u001b[39;00m\n","File \u001b[0;32m~/.pyenv/versions/3.12.0/lib/python3.12/site-packages/matplotlib/colors.py:503\u001b[0m, in \u001b[0;36mto_rgba_array\u001b[0;34m(c, alpha)\u001b[0m\n\u001b[1;32m    502\u001b[0m     \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[0;32m--> 503\u001b[0m         rgba \u001b[38;5;241m=\u001b[39m np\u001b[38;5;241m.\u001b[39marray([\u001b[43mto_rgba\u001b[49m\u001b[43m(\u001b[49m\u001b[43mcc\u001b[49m\u001b[43m)\u001b[49m \u001b[38;5;28;01mfor\u001b[39;00m cc \u001b[38;5;129;01min\u001b[39;00m c])\n\u001b[1;32m    504\u001b[0m \u001b[38;5;28;01melse\u001b[39;00m:\n","File \u001b[0;32m~/.pyenv/versions/3.12.0/lib/python3.12/site-packages/matplotlib/colors.py:302\u001b[0m, in \u001b[0;36mto_rgba\u001b[0;34m(c, alpha)\u001b[0m\n\u001b[1;32m    301\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m rgba \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:  \u001b[38;5;66;03m# Suppress exception chaining of cache lookup failure.\u001b[39;00m\n\u001b[0;32m--> 302\u001b[0m     rgba \u001b[38;5;241m=\u001b[39m \u001b[43m_to_rgba_no_colorcycle\u001b[49m\u001b[43m(\u001b[49m\u001b[43mc\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43malpha\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m    303\u001b[0m     \u001b[38;5;28;01mtry\u001b[39;00m:\n","File \u001b[0;32m~/.pyenv/versions/3.12.0/lib/python3.12/site-packages/matplotlib/colors.py:384\u001b[0m, in \u001b[0;36m_to_rgba_no_colorcycle\u001b[0;34m(c, alpha)\u001b[0m\n\u001b[1;32m    383\u001b[0m         \u001b[38;5;28;01mreturn\u001b[39;00m c, c, c, alpha \u001b[38;5;28;01mif\u001b[39;00m alpha \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m \u001b[38;5;28;01melse\u001b[39;00m \u001b[38;5;241m1.\u001b[39m\n\u001b[0;32m--> 384\u001b[0m     \u001b[38;5;28;01mraise\u001b[39;00m \u001b[38;5;167;01mValueError\u001b[39;00m(\u001b[38;5;124mf\u001b[39m\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mInvalid RGBA argument: \u001b[39m\u001b[38;5;132;01m{\u001b[39;00morig_c\u001b[38;5;132;01m!r}\u001b[39;00m\u001b[38;5;124m\"\u001b[39m)\n\u001b[1;32m    385\u001b[0m \u001b[38;5;66;03m# turn 2-D array into 1-D array\u001b[39;00m\n","\u001b[0;31mValueError\u001b[0m: Invalid RGBA argument: 'lack'","\nDuring handling of the above exception, another exception occurred:\n","\u001b[0;31mKeyboardInterrupt\u001b[0m                         Traceback (most recent call last)","Cell \u001b[0;32mIn[232], line 39\u001b[0m\n\u001b[1;32m     22\u001b[0m     \u001b[38;5;66;03m# TODO: abs scale for these 2\u001b[39;00m\n\u001b[1;32m     23\u001b[0m     \u001b[38;5;66;03m# _land = ax.contourf(\u001b[39;00m\n\u001b[1;32m     24\u001b[0m     \u001b[38;5;66;03m#     x,\u001b[39;00m\n\u001b[0;32m   (...)\u001b[0m\n\u001b[1;32m     30\u001b[0m     \u001b[38;5;66;03m#     **kwargs,\u001b[39;00m\n\u001b[1;32m     31\u001b[0m     \u001b[38;5;66;03m# )\u001b[39;00m\n\u001b[1;32m     33\u001b[0m     _land \u001b[38;5;241m=\u001b[39m ax\u001b[38;5;241m.\u001b[39mimshow(\n\u001b[1;32m     34\u001b[0m         land_zs,\n\u001b[1;32m     35\u001b[0m         cmap\u001b[38;5;241m=\u001b[39mland_cmap,\n\u001b[1;32m     36\u001b[0m         \u001b[38;5;241m*\u001b[39m\u001b[38;5;241m*\u001b[39mkwargs,\n\u001b[1;32m     37\u001b[0m     )\n\u001b[0;32m---> 39\u001b[0m     _elevation \u001b[38;5;241m=\u001b[39m \u001b[43max\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mcontour\u001b[49m\u001b[43m(\u001b[49m\n\u001b[1;32m     40\u001b[0m \u001b[43m        \u001b[49m\u001b[38;5;66;43;03m# x,\u001b[39;49;00m\n\u001b[1;32m     41\u001b[0m \u001b[43m        \u001b[49m\u001b[38;5;66;43;03m# y,\u001b[39;49;00m\n\u001b[1;32m     42\u001b[0m \u001b[43m        \u001b[49m\u001b[43mland_zs\u001b[49m\u001b[43m,\u001b[49m\n\u001b[1;32m     43\u001b[0m \u001b[43m        \u001b[49m\u001b[38;5;66;43;03m# levels=np.arange(land_zs.min(), z_max + 1000, step=1000),\u001b[39;49;00m\n\u001b[1;32m     44\u001b[0m \u001b[43m        \u001b[49m\u001b[43mlevels\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[43m[\u001b[49m\u001b[43mland_zs\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mmin\u001b[49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mland_zs\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mmin\u001b[49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;241;43m+\u001b[39;49m\u001b[43m \u001b[49m\u001b[43mland_zs\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mmax\u001b[49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;241;43m/\u001b[39;49m\u001b[43m \u001b[49m\u001b[38;5;241;43m2\u001b[39;49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43mland_zs\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mmax\u001b[49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m\u001b[43m]\u001b[49m\u001b[43m,\u001b[49m\n\u001b[1;32m     45\u001b[0m \u001b[43m        \u001b[49m\u001b[43mlinestyles\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[38;5;124;43mdashed\u001b[39;49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[43m,\u001b[49m\n\u001b[1;32m     46\u001b[0m \u001b[43m        \u001b[49m\u001b[43mlinewidths\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[38;5;241;43m0.75\u001b[39;49m\u001b[43m,\u001b[49m\n\u001b[1;32m     47\u001b[0m \u001b[43m        \u001b[49m\u001b[43mcolors\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[38;5;124;43mblack\u001b[39;49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[43m,\u001b[49m\n\u001b[1;32m     48\u001b[0m \u001b[43m        \u001b[49m\u001b[43mextend\u001b[49m\u001b[38;5;241;43m=\u001b[39;49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[38;5;124;43mboth\u001b[39;49m\u001b[38;5;124;43m\"\u001b[39;49m\u001b[43m,\u001b[49m\n\u001b[1;32m     49\u001b[0m \u001b[43m        \u001b[49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[43mkwargs\u001b[49m\u001b[43m,\u001b[49m\n\u001b[1;32m     50\u001b[0m \u001b[43m    \u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m     52\u001b[0m     \u001b[38;5;66;03m# ax.imshow(grp.variables[\"H\"][:][::-1])\u001b[39;00m\n\u001b[1;32m     54\u001b[0m \u001b[38;5;28;01mfor\u001b[39;00m ax \u001b[38;5;129;01min\u001b[39;00m axes\u001b[38;5;241m.\u001b[39mflat:\n","File \u001b[0;32m~/.pyenv/versions/3.12.0/lib/python3.12/site-packages/matplotlib/__init__.py:1465\u001b[0m, in \u001b[0;36m_preprocess_data.<locals>.inner\u001b[0;34m(ax, data, *args, **kwargs)\u001b[0m\n\u001b[1;32m   1462\u001b[0m \u001b[38;5;129m@functools\u001b[39m\u001b[38;5;241m.\u001b[39mwraps(func)\n\u001b[1;32m   1463\u001b[0m \u001b[38;5;28;01mdef\u001b[39;00m \u001b[38;5;21minner\u001b[39m(ax, \u001b[38;5;241m*\u001b[39margs, data\u001b[38;5;241m=\u001b[39m\u001b[38;5;28;01mNone\u001b[39;00m, \u001b[38;5;241m*\u001b[39m\u001b[38;5;241m*\u001b[39mkwargs):\n\u001b[1;32m   1464\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m data \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[0;32m-> 1465\u001b[0m         \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[43mfunc\u001b[49m\u001b[43m(\u001b[49m\u001b[43max\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[38;5;28;43mmap\u001b[39;49m\u001b[43m(\u001b[49m\u001b[43msanitize_sequence\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[43margs\u001b[49m\u001b[43m)\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[43mkwargs\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m   1467\u001b[0m     bound \u001b[38;5;241m=\u001b[39m new_sig\u001b[38;5;241m.\u001b[39mbind(ax, \u001b[38;5;241m*\u001b[39margs, \u001b[38;5;241m*\u001b[39m\u001b[38;5;241m*\u001b[39mkwargs)\n\u001b[1;32m   1468\u001b[0m     auto_label \u001b[38;5;241m=\u001b[39m (bound\u001b[38;5;241m.\u001b[39marguments\u001b[38;5;241m.\u001b[39mget(label_namer)\n\u001b[1;32m   1469\u001b[0m                   \u001b[38;5;129;01mor\u001b[39;00m bound\u001b[38;5;241m.\u001b[39mkwargs\u001b[38;5;241m.\u001b[39mget(label_namer))\n","File \u001b[0;32m~/.pyenv/versions/3.12.0/lib/python3.12/site-packages/matplotlib/axes/_axes.py:6512\u001b[0m, in \u001b[0;36mAxes.contour\u001b[0;34m(self, *args, **kwargs)\u001b[0m\n\u001b[1;32m   6503\u001b[0m \u001b[38;5;250m\u001b[39m\u001b[38;5;124;03m\"\"\"\u001b[39;00m\n\u001b[1;32m   6504\u001b[0m \u001b[38;5;124;03mPlot contour lines.\u001b[39;00m\n\u001b[1;32m   6505\u001b[0m \n\u001b[0;32m   (...)\u001b[0m\n\u001b[1;32m   6509\u001b[0m \u001b[38;5;124;03m%(contour_doc)s\u001b[39;00m\n\u001b[1;32m   6510\u001b[0m \u001b[38;5;124;03m\"\"\"\u001b[39;00m\n\u001b[1;32m   6511\u001b[0m kwargs[\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mfilled\u001b[39m\u001b[38;5;124m'\u001b[39m] \u001b[38;5;241m=\u001b[39m \u001b[38;5;28;01mFalse\u001b[39;00m\n\u001b[0;32m-> 6512\u001b[0m contours \u001b[38;5;241m=\u001b[39m \u001b[43mmcontour\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mQuadContourSet\u001b[49m\u001b[43m(\u001b[49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[43margs\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[43mkwargs\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m   6513\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_request_autoscale_view()\n\u001b[1;32m   6514\u001b[0m \u001b[38;5;28;01mreturn\u001b[39;00m contours\n","File \u001b[0;32m~/.pyenv/versions/3.12.0/lib/python3.12/site-packages/matplotlib/contour.py:887\u001b[0m, in \u001b[0;36mContourSet.__init__\u001b[0;34m(self, ax, levels, filled, linewidths, linestyles, hatches, alpha, origin, extent, cmap, colors, norm, vmin, vmax, extend, antialiased, nchunk, locator, transform, negative_linestyles, clip_path, *args, **kwargs)\u001b[0m\n\u001b[1;32m    884\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mlabelTexts \u001b[38;5;241m=\u001b[39m []\n\u001b[1;32m    885\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mlabelCValues \u001b[38;5;241m=\u001b[39m []\n\u001b[0;32m--> 887\u001b[0m \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mset_cmap\u001b[49m\u001b[43m(\u001b[49m\u001b[43mcmap\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m    888\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m norm \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[1;32m    889\u001b[0m     \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mset_norm(norm)\n","File \u001b[0;32m~/.pyenv/versions/3.12.0/lib/python3.12/site-packages/matplotlib/cm.py:602\u001b[0m, in \u001b[0;36mScalarMappable.set_cmap\u001b[0;34m(self, cmap)\u001b[0m\n\u001b[1;32m    600\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mcmap \u001b[38;5;241m=\u001b[39m _ensure_cmap(cmap)\n\u001b[1;32m    601\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m in_init:\n\u001b[0;32m--> 602\u001b[0m     \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mchanged\u001b[49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m\n","File \u001b[0;32m~/.pyenv/versions/3.12.0/lib/python3.12/site-packages/matplotlib/contour.py:1145\u001b[0m, in \u001b[0;36mContourSet.changed\u001b[0;34m(self)\u001b[0m\n\u001b[1;32m   1143\u001b[0m \u001b[38;5;28;01mdef\u001b[39;00m \u001b[38;5;21mchanged\u001b[39m(\u001b[38;5;28mself\u001b[39m):\n\u001b[1;32m   1144\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28mhasattr\u001b[39m(\u001b[38;5;28mself\u001b[39m, \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mcvalues\u001b[39m\u001b[38;5;124m\"\u001b[39m):\n\u001b[0;32m-> 1145\u001b[0m         \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43m_process_colors\u001b[49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m  \u001b[38;5;66;03m# Sets cvalues.\u001b[39;00m\n\u001b[1;32m   1146\u001b[0m     \u001b[38;5;66;03m# Force an autoscale immediately because self.to_rgba() calls\u001b[39;00m\n\u001b[1;32m   1147\u001b[0m     \u001b[38;5;66;03m# autoscale_None() internally with the data passed to it,\u001b[39;00m\n\u001b[1;32m   1148\u001b[0m     \u001b[38;5;66;03m# so if vmin/vmax are not set yet, this would override them with\u001b[39;00m\n\u001b[1;32m   1149\u001b[0m     \u001b[38;5;66;03m# content from *cvalues* rather than levels like we want\u001b[39;00m\n\u001b[1;32m   1150\u001b[0m     \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mnorm\u001b[38;5;241m.\u001b[39mautoscale_None(\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mlevels)\n","File \u001b[0;32m~/.pyenv/versions/3.12.0/lib/python3.12/site-packages/matplotlib/contour.py:1299\u001b[0m, in \u001b[0;36mContourSet._process_colors\u001b[0;34m(self)\u001b[0m\n\u001b[1;32m   1297\u001b[0m             i1 \u001b[38;5;241m+\u001b[39m\u001b[38;5;241m=\u001b[39m \u001b[38;5;241m1\u001b[39m\n\u001b[1;32m   1298\u001b[0m     \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mcvalues \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mlist\u001b[39m(\u001b[38;5;28mrange\u001b[39m(i0, i1))\n\u001b[0;32m-> 1299\u001b[0m     \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mset_norm\u001b[49m\u001b[43m(\u001b[49m\u001b[43mmcolors\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mNoNorm\u001b[49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m   1300\u001b[0m \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[1;32m   1301\u001b[0m     \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mcvalues \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mlayers\n","File \u001b[0;32m~/.pyenv/versions/3.12.0/lib/python3.12/site-packages/matplotlib/cm.py:651\u001b[0m, in \u001b[0;36mScalarMappable.set_norm\u001b[0;34m(self, norm)\u001b[0m\n\u001b[1;32m    637\u001b[0m \u001b[38;5;28;01mdef\u001b[39;00m \u001b[38;5;21mset_norm\u001b[39m(\u001b[38;5;28mself\u001b[39m, norm):\n\u001b[1;32m    638\u001b[0m \u001b[38;5;250m    \u001b[39m\u001b[38;5;124;03m\"\"\"\u001b[39;00m\n\u001b[1;32m    639\u001b[0m \u001b[38;5;124;03m    Set the normalization instance.\u001b[39;00m\n\u001b[1;32m    640\u001b[0m \n\u001b[0;32m   (...)\u001b[0m\n\u001b[1;32m    649\u001b[0m \u001b[38;5;124;03m    on the colorbar to default.\u001b[39;00m\n\u001b[1;32m    650\u001b[0m \u001b[38;5;124;03m    \"\"\"\u001b[39;00m\n\u001b[0;32m--> 651\u001b[0m     \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mnorm\u001b[49m \u001b[38;5;241m=\u001b[39m norm\n","File \u001b[0;32m~/.pyenv/versions/3.12.0/lib/python3.12/site-packages/matplotlib/cm.py:635\u001b[0m, in \u001b[0;36mScalarMappable.norm\u001b[0;34m(self, norm)\u001b[0m\n\u001b[1;32m    632\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_id_norm \u001b[38;5;241m=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mnorm\u001b[38;5;241m.\u001b[39mcallbacks\u001b[38;5;241m.\u001b[39mconnect(\u001b[38;5;124m'\u001b[39m\u001b[38;5;124mchanged\u001b[39m\u001b[38;5;124m'\u001b[39m,\n\u001b[1;32m    633\u001b[0m                                             \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mchanged)\n\u001b[1;32m    634\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m in_init:\n\u001b[0;32m--> 635\u001b[0m     \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mchanged\u001b[49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m\n","File \u001b[0;32m~/.pyenv/versions/3.12.0/lib/python3.12/site-packages/matplotlib/contour.py:1150\u001b[0m, in \u001b[0;36mContourSet.changed\u001b[0;34m(self)\u001b[0m\n\u001b[1;32m   1145\u001b[0m     \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_process_colors()  \u001b[38;5;66;03m# Sets cvalues.\u001b[39;00m\n\u001b[1;32m   1146\u001b[0m \u001b[38;5;66;03m# Force an autoscale immediately because self.to_rgba() calls\u001b[39;00m\n\u001b[1;32m   1147\u001b[0m \u001b[38;5;66;03m# autoscale_None() internally with the data passed to it,\u001b[39;00m\n\u001b[1;32m   1148\u001b[0m \u001b[38;5;66;03m# so if vmin/vmax are not set yet, this would override them with\u001b[39;00m\n\u001b[1;32m   1149\u001b[0m \u001b[38;5;66;03m# content from *cvalues* rather than levels like we want\u001b[39;00m\n\u001b[0;32m-> 1150\u001b[0m \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mnorm\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mautoscale_None\u001b[49m\u001b[43m(\u001b[49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mlevels\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m   1151\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mset_array(\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mcvalues)\n\u001b[1;32m   1152\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mupdate_scalarmappable()\n","File \u001b[0;32m~/.pyenv/versions/3.12.0/lib/python3.12/site-packages/matplotlib/colors.py:1408\u001b[0m, in \u001b[0;36mNormalize.autoscale_None\u001b[0;34m(self, A)\u001b[0m\n\u001b[1;32m   1405\u001b[0m         A \u001b[38;5;241m=\u001b[39m A\u001b[38;5;241m.\u001b[39mdata\n\u001b[1;32m   1407\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mvmin \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m \u001b[38;5;129;01mand\u001b[39;00m A\u001b[38;5;241m.\u001b[39msize:\n\u001b[0;32m-> 1408\u001b[0m     \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mvmin\u001b[49m \u001b[38;5;241m=\u001b[39m A\u001b[38;5;241m.\u001b[39mmin()\n\u001b[1;32m   1409\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mvmax \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m \u001b[38;5;129;01mand\u001b[39;00m A\u001b[38;5;241m.\u001b[39msize:\n\u001b[1;32m   1410\u001b[0m     \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mvmax \u001b[38;5;241m=\u001b[39m A\u001b[38;5;241m.\u001b[39mmax()\n","File \u001b[0;32m~/.pyenv/versions/3.12.0/lib/python3.12/site-packages/matplotlib/colors.py:1264\u001b[0m, in \u001b[0;36mNormalize.vmin\u001b[0;34m(self, value)\u001b[0m\n\u001b[1;32m   1262\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m value \u001b[38;5;241m!=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_vmin:\n\u001b[1;32m   1263\u001b[0m     \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_vmin \u001b[38;5;241m=\u001b[39m value\n\u001b[0;32m-> 1264\u001b[0m     \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43m_changed\u001b[49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m\n","File \u001b[0;32m~/.pyenv/versions/3.12.0/lib/python3.12/site-packages/matplotlib/colors.py:1292\u001b[0m, in \u001b[0;36mNormalize._changed\u001b[0;34m(self)\u001b[0m\n\u001b[1;32m   1287\u001b[0m \u001b[38;5;28;01mdef\u001b[39;00m \u001b[38;5;21m_changed\u001b[39m(\u001b[38;5;28mself\u001b[39m):\n\u001b[1;32m   1288\u001b[0m \u001b[38;5;250m    \u001b[39m\u001b[38;5;124;03m\"\"\"\u001b[39;00m\n\u001b[1;32m   1289\u001b[0m \u001b[38;5;124;03m    Call this whenever the norm is changed to notify all the\u001b[39;00m\n\u001b[1;32m   1290\u001b[0m \u001b[38;5;124;03m    callback listeners to the 'changed' signal.\u001b[39;00m\n\u001b[1;32m   1291\u001b[0m \u001b[38;5;124;03m    \"\"\"\u001b[39;00m\n\u001b[0;32m-> 1292\u001b[0m     \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mcallbacks\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mprocess\u001b[49m\u001b[43m(\u001b[49m\u001b[38;5;124;43m'\u001b[39;49m\u001b[38;5;124;43mchanged\u001b[39;49m\u001b[38;5;124;43m'\u001b[39;49m\u001b[43m)\u001b[49m\n","File \u001b[0;32m~/.pyenv/versions/3.12.0/lib/python3.12/site-packages/matplotlib/cbook.py:298\u001b[0m, in \u001b[0;36mCallbackRegistry.process\u001b[0;34m(self, s, *args, **kwargs)\u001b[0m\n\u001b[1;32m    296\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m func \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[1;32m    297\u001b[0m     \u001b[38;5;28;01mtry\u001b[39;00m:\n\u001b[0;32m--> 298\u001b[0m         \u001b[43mfunc\u001b[49m\u001b[43m(\u001b[49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[43margs\u001b[49m\u001b[43m,\u001b[49m\u001b[43m \u001b[49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[38;5;241;43m*\u001b[39;49m\u001b[43mkwargs\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m    299\u001b[0m     \u001b[38;5;66;03m# this does not capture KeyboardInterrupt, SystemExit,\u001b[39;00m\n\u001b[1;32m    300\u001b[0m     \u001b[38;5;66;03m# and GeneratorExit\u001b[39;00m\n\u001b[1;32m    301\u001b[0m     \u001b[38;5;28;01mexcept\u001b[39;00m \u001b[38;5;167;01mException\u001b[39;00m \u001b[38;5;28;01mas\u001b[39;00m exc:\n","File \u001b[0;32m~/.pyenv/versions/3.12.0/lib/python3.12/site-packages/matplotlib/contour.py:1150\u001b[0m, in \u001b[0;36mContourSet.changed\u001b[0;34m(self)\u001b[0m\n\u001b[1;32m   1145\u001b[0m     \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_process_colors()  \u001b[38;5;66;03m# Sets cvalues.\u001b[39;00m\n\u001b[1;32m   1146\u001b[0m \u001b[38;5;66;03m# Force an autoscale immediately because self.to_rgba() calls\u001b[39;00m\n\u001b[1;32m   1147\u001b[0m \u001b[38;5;66;03m# autoscale_None() internally with the data passed to it,\u001b[39;00m\n\u001b[1;32m   1148\u001b[0m \u001b[38;5;66;03m# so if vmin/vmax are not set yet, this would override them with\u001b[39;00m\n\u001b[1;32m   1149\u001b[0m \u001b[38;5;66;03m# content from *cvalues* rather than levels like we want\u001b[39;00m\n\u001b[0;32m-> 1150\u001b[0m \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mnorm\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mautoscale_None\u001b[49m\u001b[43m(\u001b[49m\u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mlevels\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m   1151\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mset_array(\u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mcvalues)\n\u001b[1;32m   1152\u001b[0m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mupdate_scalarmappable()\n","File \u001b[0;32m~/.pyenv/versions/3.12.0/lib/python3.12/site-packages/matplotlib/colors.py:1410\u001b[0m, in \u001b[0;36mNormalize.autoscale_None\u001b[0;34m(self, A)\u001b[0m\n\u001b[1;32m   1408\u001b[0m     \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mvmin \u001b[38;5;241m=\u001b[39m A\u001b[38;5;241m.\u001b[39mmin()\n\u001b[1;32m   1409\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mvmax \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m \u001b[38;5;129;01mand\u001b[39;00m A\u001b[38;5;241m.\u001b[39msize:\n\u001b[0;32m-> 1410\u001b[0m     \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mvmax\u001b[49m \u001b[38;5;241m=\u001b[39m A\u001b[38;5;241m.\u001b[39mmax()\n","File \u001b[0;32m~/.pyenv/versions/3.12.0/lib/python3.12/site-packages/matplotlib/colors.py:1275\u001b[0m, in \u001b[0;36mNormalize.vmax\u001b[0;34m(self, value)\u001b[0m\n\u001b[1;32m   1273\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m value \u001b[38;5;241m!=\u001b[39m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_vmax:\n\u001b[1;32m   1274\u001b[0m     \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39m_vmax \u001b[38;5;241m=\u001b[39m value\n\u001b[0;32m-> 1275\u001b[0m     \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43m_changed\u001b[49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m\n","File \u001b[0;32m~/.pyenv/versions/3.12.0/lib/python3.12/site-packages/matplotlib/colors.py:1292\u001b[0m, in \u001b[0;36mNormalize._changed\u001b[0;34m(self)\u001b[0m\n\u001b[1;32m   1287\u001b[0m \u001b[38;5;28;01mdef\u001b[39;00m \u001b[38;5;21m_changed\u001b[39m(\u001b[38;5;28mself\u001b[39m):\n\u001b[1;32m   1288\u001b[0m \u001b[38;5;250m    \u001b[39m\u001b[38;5;124;03m\"\"\"\u001b[39;00m\n\u001b[1;32m   1289\u001b[0m \u001b[38;5;124;03m    Call this whenever the norm is changed to notify all the\u001b[39;00m\n\u001b[1;32m   1290\u001b[0m \u001b[38;5;124;03m    callback listeners to the 'changed' signal.\u001b[39;00m\n\u001b[1;32m   1291\u001b[0m \u001b[38;5;124;03m    \"\"\"\u001b[39;00m\n\u001b[0;32m-> 1292\u001b[0m     \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mcallbacks\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mprocess\u001b[49m\u001b[43m(\u001b[49m\u001b[38;5;124;43m'\u001b[39;49m\u001b[38;5;124;43mchanged\u001b[39;49m\u001b[38;5;124;43m'\u001b[39;49m\u001b[43m)\u001b[49m\n","File \u001b[0;32m~/.pyenv/versions/3.12.0/lib/python3.12/site-packages/matplotlib/cbook.py:303\u001b[0m, in \u001b[0;36mCallbackRegistry.process\u001b[0;34m(self, s, *args, **kwargs)\u001b[0m\n\u001b[1;32m    301\u001b[0m \u001b[38;5;28;01mexcept\u001b[39;00m \u001b[38;5;167;01mException\u001b[39;00m \u001b[38;5;28;01mas\u001b[39;00m exc:\n\u001b[1;32m    302\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;28mself\u001b[39m\u001b[38;5;241m.\u001b[39mexception_handler \u001b[38;5;129;01mis\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m:\n\u001b[0;32m--> 303\u001b[0m         \u001b[38;5;28;43mself\u001b[39;49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mexception_handler\u001b[49m\u001b[43m(\u001b[49m\u001b[43mexc\u001b[49m\u001b[43m)\u001b[49m\n\u001b[1;32m    304\u001b[0m     \u001b[38;5;28;01melse\u001b[39;00m:\n\u001b[1;32m    305\u001b[0m         \u001b[38;5;28;01mraise\u001b[39;00m\n","File \u001b[0;32m~/.pyenv/versions/3.12.0/lib/python3.12/site-packages/matplotlib/cbook.py:86\u001b[0m, in \u001b[0;36m_exception_printer\u001b[0;34m(exc)\u001b[0m\n\u001b[1;32m     85\u001b[0m \u001b[38;5;28;01mdef\u001b[39;00m \u001b[38;5;21m_exception_printer\u001b[39m(exc):\n\u001b[0;32m---> 86\u001b[0m     \u001b[38;5;28;01mif\u001b[39;00m \u001b[43m_get_running_interactive_framework\u001b[49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m \u001b[38;5;129;01min\u001b[39;00m [\u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mheadless\u001b[39m\u001b[38;5;124m\"\u001b[39m, \u001b[38;5;28;01mNone\u001b[39;00m]:\n\u001b[1;32m     87\u001b[0m         \u001b[38;5;28;01mraise\u001b[39;00m exc\n\u001b[1;32m     88\u001b[0m     \u001b[38;5;28;01melse\u001b[39;00m:\n","File \u001b[0;32m~/.pyenv/versions/3.12.0/lib/python3.12/site-packages/matplotlib/cbook.py:80\u001b[0m, in \u001b[0;36m_get_running_interactive_framework\u001b[0;34m()\u001b[0m\n\u001b[1;32m     78\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m macosx \u001b[38;5;129;01mand\u001b[39;00m macosx\u001b[38;5;241m.\u001b[39mevent_loop_is_running():\n\u001b[1;32m     79\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mmacosx\u001b[39m\u001b[38;5;124m\"\u001b[39m\n\u001b[0;32m---> 80\u001b[0m \u001b[38;5;28;01mif\u001b[39;00m \u001b[38;5;129;01mnot\u001b[39;00m \u001b[43m_c_internal_utils\u001b[49m\u001b[38;5;241;43m.\u001b[39;49m\u001b[43mdisplay_is_valid\u001b[49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m:\n\u001b[1;32m     81\u001b[0m     \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;124m\"\u001b[39m\u001b[38;5;124mheadless\u001b[39m\u001b[38;5;124m\"\u001b[39m\n\u001b[1;32m     82\u001b[0m \u001b[38;5;28;01mreturn\u001b[39;00m \u001b[38;5;28;01mNone\u001b[39;00m\n","\u001b[0;31mKeyboardInterrupt\u001b[0m: "]},{"data":{"image/png":"/images/notebooks/simulating_ice/cell_output_43_1.png","text/plain":["<Figure size 1000x700 with 6 Axes>"]},"metadata":{},"output_type":"display_data"}],"source":["from matplotlib.colors import hex2color, LinearSegmentedColormap\n","\n","fig, axes = plt.subplots(nrows=2, ncols=3, figsize=(10, 7), layout=\"constrained\")\n","land_cmap = LinearSegmentedColormap.from_list(\"\", [hex2color(\"#cda892\"), hex2color(\"#352c26\")])\n","\n","\n","for i, (year, vars) in enumerate(data.items()):\n","    ax = axes.flat[i]\n","    ax.set_title(f\"t = {year:.0f}\")\n","\n","    as_perp, H, lat, lon, mask, zs = vars.values()\n","    land_mask = (mask == 0) | (mask == 1)\n","    SMB = (H > 0) * as_perp * 916.7\n","\n","    x, y = [lon, lat]\n","    zs = zs.reshape(x.shape)\n","    land_zs = np.ma.masked_where(~land_mask, zs)\n","\n","    extent = [x.min(), x.max(), y.min(), y.max()]\n","    kwargs = dict(extent=extent, origin=\"lower\", alpha=0.3)\n","\n","    # TODO: abs scale for these 2\n","    # _land = ax.contourf(\n","    #     x,\n","    #     y,\n","    #     land_zs,\n","    #     levels=np.arange(z_min, z_max + 100, step=100),\n","    #     antialiased=True,\n","    #     cmap=land_cmap,\n","    #     **kwargs,\n","    # )\n","\n","    _land = ax.imshow(\n","        land_zs,\n","        cmap=land_cmap,\n","        **kwargs,\n","    )\n","\n","    _elevation = ax.contour(\n","        # x,\n","        # y,\n","        land_zs,\n","        levels=np.arange(land_zs.min(), z_max + 1000, step=1000),\n","        # levels=[land_zs.min(), land_zs.min() + land_zs.max() / 2, land_zs.max()],\n","        linestyles=\"dashed\",\n","        linewidths=0.75,\n","        colors=\"black\",\n","        extend=\"both\",\n","        **kwargs,\n","    )\n","\n","    # ax.imshow(grp.variables[\"H\"][:][::-1])\n","\n","for ax in axes.flat:\n","    ax.set_aspect(4)\n","    ax.set_xticks([])\n","    ax.set_yticks([])"]}}/>

<Cell cell={{"cell_type":"code","execution_count":null,"metadata":{"language":"python"},"outputs":[{"data":{"image/png":"/images/notebooks/simulating_ice/cell_output_44_0.png","text/plain":["<Figure size 640x480 with 1 Axes>"]},"metadata":{},"output_type":"display_data"}],"source":["x = list(data.values())[0]\n","plt.contourf(\n","    # x[\"lon\"],\n","    # x[\"lat\"],\n","    np.ma.masked_where(~((x[\"mask\"] == 0) | (x[\"mask\"] == 1)), x[\"zs\"]),\n","    extent=[x[\"lon\"].min(), x[\"lon\"].max(), x[\"lat\"].min(), x[\"lat\"].max()],\n","    origin=\"lower\",\n",")\n","plt.grid(False)\n","plt.gca().set_aspect(4)"]}}/>

<Cell cell={{"cell_type":"code","execution_count":null,"metadata":{"language":"python"},"outputs":[{"data":{"image/png":"/images/notebooks/simulating_ice/cell_output_45_0.png","text/plain":["<Figure size 640x480 with 1 Axes>"]},"metadata":{},"output_type":"display_data"}],"source":["plt.imshow(\n","    np.ma.masked_where(~((x[\"mask\"] == 0) | (x[\"mask\"] == 1)), x[\"zs\"]),\n","    origin=\"lower\",\n","    cmap=land_cmap,\n","    extent=[x[\"lon\"].min(), x[\"lon\"].max(), x[\"lat\"].min(), x[\"lat\"].max()],\n",")\n","\n","plt.contourf(\n","    x[\"lon\"],\n","    x[\"lat\"],\n","    np.ma.masked_where(~((x[\"mask\"] == 2) | (x[\"mask\"] == 1)), x[\"zs\"]),\n","    extent=[x[\"lon\"].min(), x[\"lon\"].max(), x[\"lat\"].min(), x[\"lat\"].max()],\n","    origin=\"lower\",\n",")\n","\n","plt.grid(False)\n","plt.gca().set_aspect(4)"]}}/>

<Cell cell={{"cell_type":"code","execution_count":null,"metadata":{"language":"python"},"outputs":[{"data":{"image/png":"/images/notebooks/simulating_ice/cell_output_46_0.png","text/plain":["<Figure size 640x480 with 1 Axes>"]},"metadata":{},"output_type":"display_data"}],"source":["extent = [x.min(), x.max(), y.min(), y.max()]\n","\n","land = plt.contourf(\n","    x,\n","    y,\n","    zs,\n","    levels=np.arange(0, zs.max() + 100, step=100),\n","    antialiased=True,\n","    origin=\"lower\",\n","    extent=extent,\n","    cmap=cmap,\n","    alpha=0.3,\n","    zorder=1,\n",")\n","\n","elevation = plt.contour(\n","    x,\n","    y,\n","    zs,\n","    levels=np.arange(0, H.max() + 750, step=750),\n","    linestyles=\"dashed\",\n","    linewidths=0.75,\n","    origin=\"lower\",\n","    colors=\"black\",\n","    extent=extent,\n","    alpha=0.4,\n",")\n","\n","plt.gca().set_aspect(\"auto\")\n","plt.grid(False)"]}}/>

</Collapsed>

# Conclusions

